<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bâ€™s Beauty Blossom</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
<header>
  <nav class="navbar">
    <div class="logo"><a href="index.html"><span class="logo-mark">Bâ€™s</span> Beauty Blossom</a></div>
    <ul class="nav-links">
      <li><a class="active" href="index.html">Home</a></li>
      <li><a href="perfume.html">Perfume</a></li>
      <li><a href="body.html">Body</a></li>
      <li><a href="skincare.html">Skincare</a></li>
      <li><a href="cosmetics.html">Cosmetics</a></li>
      <li><a href="jewellery.html">Jewellery</a></li>
      <li><a href="gift.html">Gift</a></li>
      <li><a href="cart.html">ðŸ›’ Cart (<span id="cart-count">0</span>)</a></li>
      <li><a href="admin.html">Admin</a></li>
    </ul>
    <button class="hamburger" aria-label="menu" aria-expanded="false">&#9776;</button>
  </nav>
</header>

<!-- Hero Section (SPLIT: image left, text right) -->
<section id="hero" class="hero hero-split container">
  <div class="hero-media">
    <img id="hero-banner" src="https://via.placeholder.com/1200x600?text=Banner" alt="Banner" class="hero-img">
  </div>
  <div class="hero-side">
    <h1 id="hero-title">Welcome to Bâ€™s Beauty Blossom</h1>
    <p id="hero-subtitle">Curated beauty & fragrances</p>
    <div class="hero-cta">
      <a class="btn" href="perfume.html">Shop Perfume</a>
      <a class="btn muted" href="skincare.html">Shop Skincare</a>
    </div>
  </div>
</section>

<!-- Featured Products Section -->
<section id="featured-section" class="section container">
  <div class="section-head">
    <h2>Featured Products</h2>
  </div>
  <div id="home-featured" class="product-grid">
    <p>Loading featured productsâ€¦</p>
  </div>
</section>

<!-- Gallery (Carousel) -->
<section id="gallery-section" class="section container">
  <div class="section-head">
    <h2>Our Collection</h2>
    <div class="gallery-cta">
      <button class="carousel-btn" id="gal-prev" aria-label="Previous">â€¹</button>
      <button class="carousel-btn" id="gal-next" aria-label="Next">â€º</button>
    </div>
  </div>

  <div class="carousel" id="gallery-carousel">
    <div class="carousel-track" id="gallery-track">
      <!-- JS will insert slides here -->
    </div>
  </div>
  <div class="carousel-dots" id="gallery-dots"></div>
</section>

<footer class="site-footer container">
  <p>Â© 2025 Bâ€™s Beauty Blossom â€¢ All rights reserved</p>
</footer>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="firebase-config.js"></script>

<!-- Navbar + Cart (your shared helpers) -->
<script src="script.js"></script>

<!-- Home Loader + Carousel -->
<script>
(async function(){
  try {
    // Load site settings
    const snap = await db.collection('site').doc('home').get();
    const h = snap.exists ? snap.data() : {};

    // Hero content
    if (h.heroTitle) document.getElementById('hero-title').textContent = h.heroTitle;
    if (h.heroSubtitle) document.getElementById('hero-subtitle').textContent = h.heroSubtitle;
    if (h.bannerImage) document.getElementById('hero-banner').src = h.bannerImage;

    // Featured products
    if (h.showFeatured && h.featuredCategory) {
      const grid = document.getElementById('home-featured');
      const snapP = await db.collection('products')
        .where('category','==', String(h.featuredCategory).toLowerCase())
        .where('active','==', true)
        .limit(8).get();
      grid.innerHTML = '';
      if (snapP.empty) {
        grid.innerHTML = '<p>No featured products yet.</p>';
      } else {
        snapP.forEach(d => {
          const p = d.data();
          const id = d.id;
          const price = Array.isArray(p.sizes)&&p.sizes.length
            ? Math.min(...p.sizes.map(s=>Number(s.price||0)||0)) || Number(p.basePrice||0)||0
            : Number(p.basePrice||0)||0;
          const card = document.createElement('div');
          card.className = 'product';
          card.innerHTML = `
            <a href="product.html?id=${id}">
              <img src="${p.imageURL || 'https://via.placeholder.com/600x600?text=No+Image'}" alt="${p.name||''}">
            </a>
            <h3><a href="product.html?id=${id}">${p.name||''}</a></h3>
            <p class="price">${price>0 ? 'From Rs'+price : ''}</p>
          `;
          grid.appendChild(card);
        });
      }
    } else {
      document.getElementById('featured-section').style.display = 'none';
    }

    // Gallery â†’ carousel slides
    const track = document.getElementById('gallery-track');
    const dots = document.getElementById('gallery-dots');
    const prevBtn = document.getElementById('gal-prev');
    const nextBtn = document.getElementById('gal-next');

    const gallery = Array.isArray(h.gallery) ? h.gallery : [];
    if (!gallery.length) {
      track.innerHTML = '<div class="carousel-empty">No gallery images yet.</div>';
      prevBtn.style.display = 'none';
      nextBtn.style.display = 'none';
      return;
    }

    // Build slides
    gallery.forEach((url, i) => {
      const slide = document.createElement('div');
      slide.className = 'carousel-slide';
      slide.innerHTML = `<img src="${url}" alt="Gallery image ${i+1}">`;
      track.appendChild(slide);

      const dot = document.createElement('button');
      dot.className = 'dot';
      dot.setAttribute('aria-label', 'Go to slide ' + (i+1));
      dots.appendChild(dot);
    });

    // Carousel logic
    const slides = Array.from(track.children);
    const dotBtns = Array.from(dots.children);
    const carouselEl = document.getElementById('gallery-carousel');

    let curr = 0;
    function update() {
      slides.forEach((s, idx) => s.classList.toggle('is-active', idx === curr));
      dotBtns.forEach((d, idx) => d.classList.toggle('is-active', idx === curr));
      const left = slides[curr].offsetLeft;
      track.scrollTo({ left, behavior: 'smooth' });
    }
    function go(n) { curr = (n + slides.length) % slides.length; update(); }
    function next(){ go(curr + 1); }
    function prev(){ go(curr - 1); }

    nextBtn.addEventListener('click', next);
    prevBtn.addEventListener('click', prev);
    dotBtns.forEach((btn, i) => btn.addEventListener('click', () => go(i)));

    // Resize sync
    window.addEventListener('resize', update);

    // Swipe support
    let startX = null;
    carouselEl.addEventListener('pointerdown', (e) => { startX = e.clientX; });
    carouselEl.addEventListener('pointerup', (e) => {
      if (startX == null) return;
      const dx = e.clientX - startX;
      if (Math.abs(dx) > 40) (dx < 0 ? next() : prev());
      startX = null;
    });

    update();
  } catch(e) {
    console.error("Home load error:", e);
  }
})();
</script>
</body>
</html>
