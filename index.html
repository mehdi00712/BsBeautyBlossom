<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bâ€™s Beauty Blossom</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css"/>
</head>
<body>

<header>
  <nav class="navbar">
    <div class="logo">
      <a href="index.html"><span class="logo-mark">Bâ€™s</span> Beauty Blossom</a>
    </div>
    <ul class="nav-links">
      <li><a href="index.html" class="active">Home</a></li>
      <li><a href="perfume.html">Perfume</a></li>
      <li><a href="body.html">Body</a></li>
      <li><a href="skincare.html">Skincare</a></li>
      <li><a href="cosmetics.html">Cosmetics</a></li>
      <li><a href="jewellery.html">Jewellery</a></li>
      <li><a href="gift.html">Gift</a></li>
      <li><a href="cart.html">ðŸ›’ Cart (<span id="cart-count">0</span>)</a></li>
      <li><a href="admin.html">Admin</a></li>
    </ul>
    <div class="hamburger" aria-label="menu" aria-expanded="false">&#9776;</div>
  </nav>
  <div id="nav-overlay"></div>
</header>

<!-- Global search -->
<div class="section">
  <div class="search-container">
    <input type="text" id="search-bar" placeholder="Search by brand or product nameâ€¦">
    <ul id="search-suggestions"></ul>
  </div>
</div>

<!-- Hero (editable from Admin â†’ Site Settings) -->
<section id="hero" class="hero">
  <img id="hero-banner" src="https://via.placeholder.com/1600x900?text=B%27s+Beauty+Blossom" alt="Banner" class="hero-img">
  <div class="hero-overlay">
    <h1 id="hero-title">Discover Your Signature Scent</h1>
    <p id="hero-subtitle">Curated beauty & fragrances</p>
  </div>
</section>

<!-- Featured (optional; toggle in Admin â†’ Site Settings) -->
<section id="featured-section" class="section">
  <h2>Featured</h2>
  <div id="home-featured" class="product-grid">
    <p class="muted">Loadingâ€¦</p>
  </div>
</section>

<!-- Shop by Category -->
<section class="section">
  <h2>Shop by Category</h2>
  <div class="product-grid" style="grid-template-columns:repeat(6,1fr)">
    <a class="product" href="perfume.html">
      <img src="https://via.placeholder.com/800x800?text=Perfume" alt="Perfume">
      <div class="pad center"><h3>Perfume</h3></div>
    </a>
    <a class="product" href="skincare.html">
      <img src="https://via.placeholder.com/800x800?text=Skincare" alt="Skincare">
      <div class="pad center"><h3>Skincare</h3></div>
    </a>
    <a class="product" href="cosmetics.html">
      <img src="https://via.placeholder.com/800x800?text=Cosmetics" alt="Cosmetics">
      <div class="pad center"><h3>Cosmetics</h3></div>
    </a>
    <a class="product" href="body.html">
      <img src="https://via.placeholder.com/800x800?text=Body" alt="Body">
      <div class="pad center"><h3>Body</h3></div>
    </a>
    <a class="product" href="jewellery.html">
      <img src="https://via.placeholder.com/800x800?text=Jewellery" alt="Jewellery">
      <div class="pad center"><h3>Jewellery</h3></div>
    </a>
    <a class="product" href="gift.html">
      <img src="https://via.placeholder.com/800x800?text=Gift" alt="Gift">
      <div class="pad center"><h3>Gift</h3></div>
    </a>
  </div>
</section>

<footer class="site-footer">
  <p>Â© 2025 Bâ€™s Beauty Blossom â€¢ All rights reserved</p>
</footer>

<!-- Firebase (Compat) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="firebase-config.js"></script>

<!-- Navbar / cart / hamburger -->
<script src="script.js" defer></script>

<!-- Minimal home loader -->
<script>
(function(){
  function optimizeCloudinary(url, width) {
    try {
      if (!url || !/res\.cloudinary\.com/.test(url)) return url;
      return url.replace(/\/upload\/(?!.*\/)/, `/upload/f_auto,q_auto,w_${width}/`);
    } catch { return url; }
  }

  // Apply hero + (optional) featured from Firestore: site/home
  window.applyHomeData = async function(h){
    const title = document.getElementById('hero-title');
    const sub   = document.getElementById('hero-subtitle');
    const img   = document.getElementById('hero-banner');

    if (h.heroTitle) title.textContent = h.heroTitle;
    if (h.heroSubtitle) sub.textContent = h.heroSubtitle;

    if (h.bannerImage) {
      const targetW = Math.min(window.innerWidth, 1600);
      img.src = optimizeCloudinary(h.bannerImage, targetW);
    }

    const featuredWrap = document.getElementById('home-featured');
    const featuredSec  = document.getElementById('featured-section');

    if (h.showFeatured && h.featuredCategory) {
      try{
        const snap = await db.collection('products')
          .where('category','==', String(h.featuredCategory).toLowerCase())
          .where('active','==', true)
          .limit(8).get();

        featuredWrap.innerHTML = '';
        if (snap.empty) {
          featuredWrap.innerHTML = '<p class="muted">No featured products yet.</p>';
        } else {
          snap.forEach(d => {
            const p = d.data(); const id = d.id;
            const base = Number(p.basePrice || 0) || 0;
            const sizes = Array.isArray(p.sizes) ? p.sizes : [];
            const prices = sizes.map(s => Number((s && s.price) || 0)).filter(n => n > 0);
            const from = prices.length ? Math.min(...prices) : base;

            featuredWrap.insertAdjacentHTML('beforeend', `
              <a class="product" href="product.html?id=${id}">
                <img src="${p.imageURL || 'https://via.placeholder.com/600x750?text=No+Image'}" alt="${p.name||''}">
                <div class="pad">
                  <h3>${p.name||''}</h3>
                  ${p.brand ? `<div class="brand">${p.brand}</div>` : ''}
                  <div class="price">${from>0 ? 'From Rs'+from : ''}</div>
                </div>
              </a>
            `);
          });
        }
      }catch(e){
        console.error(e);
        featuredWrap.innerHTML = '<p class="muted">Couldnâ€™t load featured products.</p>';
      }
    } else {
      featuredSec.style.display = 'none';
    }

    if (window.applySearch) window.applySearch();
  };

  async function init(){
    try {
      const snap = await db.collection('site').doc('home').get();
      const h = snap.exists ? snap.data() : {};
      await window.applyHomeData(h);
    } catch(e) { console.error("Home load error:", e); }
  }

  if (document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', init, { once:true });
  } else {
    init();
  }
})();
</script>

<!-- Global search/autocomplete -->
<script src="search.js" defer></script>
</body>
</html>
